/*
 * dist Gradle build script
 */

def buildProject = project

/* Configure the workspace project */
configure(parent) {
  buildDir = buildProject.buildDir

  task build {
    dependsOn buildProject.absoluteProjectPath('jarDependencies')
    dependsOn buildProject.absoluteProjectPath('checkDependencies')
    dependsOn buildProject.absoluteProjectPath('releaseNeeded')
    description "Assembles, tests and releases the ${buildProject.name} project."
    group 'build'
  }
  defaultTasks = [build.path]
}

checkDependencies {
  mustRunAfter jarDependencies
}

releaseDependencies {
  mustRunAfter jarDependencies, checkDependencies
}

/* Configure this project */
File releaserepo = file(bnd('releaserepo', 'bundles')) /* Release repository. */

clean {
  delete releaserepo
}
